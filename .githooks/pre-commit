#!/bin/bash

set -euo pipefail

project_root="$(dirname $0)/../.."

# Redirect output to stderr.
exec 1>&2

set +e
${project_root}/gradlew spotlessCheck
set -e

reformatted_files="$(git ls-files --modified)"
if [ '' != "${reformatted_files}" ]; then
    ${project_root}/gradlew spotlessApply
    echo "ERROR: aborting commit command due to formatting errors, please review local changes and add them to the index to continue"
    exit 1
fi
